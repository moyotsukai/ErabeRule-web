webpackJsonp([1],{"3d+2":function(t,e){},JArz:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("7+uW"),a={name:"App",created:function(){document.title="ErabeRule"}},o={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("div",{attrs:{id:"header"}},[n("router-link",{staticClass:"logo",attrs:{to:"/"}},[n("img",{attrs:{src:s("QIQ4")}}),t._v(" "),n("span",[t._v("ErabeRule")])]),t._v(" "),n("div",{staticClass:"prtition-line"}),t._v(" "),n("router-link",{staticClass:"header-link",attrs:{to:"/attend"}},[t._v("参加")]),t._v(" "),n("router-link",{staticClass:"header-link",attrs:{to:"/create"}},[t._v("作成")])],1),t._v(" "),n("router-view"),t._v(" "),t._m(0)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"footer"}},[e("p",[this._v("© 2021 Shintaro Aoi")])])}]};var r=s("VU/8")(a,o,!1,function(t){s("NZ/7")},null,null).exports,i=s("/ocq"),l={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"body-padding",attrs:{id:"home-app"}},[s("div",{staticClass:"home-content"},[s("div",{staticClass:"home-section"},[s("p",[t._v("\n        ErabeRuleは、多数決に加え様々なルールを使って投票ができる投票アプリです。\n      ")]),t._v(" "),s("button",{staticClass:"primary-button",on:{click:t.start}},[t._v("はじめる")])]),t._v(" "),t._m(0),t._v(" "),t._m(1),t._v(" "),s("div",{staticClass:"home-section"},[s("p",[t._v("本アプリの投票ルールについて知る")]),t._v(" "),s("router-link",{staticClass:"primary-link",attrs:{to:"/detail"}},[t._v("本アプリの投票ルールの仕様 >")])],1),t._v(" "),s("div",{staticClass:"home-section"},[s("p",[t._v("新着情報をみる")]),t._v(" "),s("router-link",{staticClass:"primary-link",attrs:{to:"/news"}},[t._v("リリースノート >")])],1)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"home-section"},[e("p",[this._v("iOSアプリ版はこちら")]),this._v(" "),e("a",{staticClass:"primary-link",attrs:{href:"https://apps.apple.com/jp/app/eraberule/id1552835670"}},[this._v("\n        ErabeRule iOS版 ↗\n        ")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"home-section text-left"},[s("p",[t._v("\n        世の中には色々な投票ルールが存在する一方、多数決を使った投票では票割れによって漁夫の利的な勝利が発生することが知られています。しかし、ほとんどの場面では多数決しか採用されません。これにはいくつか理由がありますが、理由の一つにそもそもどのようなルールが存在するのか知られていないことが考えられます。使ったことのない方法を採用するのはハードルが高いのではないでしょうか。\n      ")]),t._v(" "),s("p",[t._v("\n        ErabeRuleは、様々な投票ルールをもっと身近なものにし、気軽に使ってみることを目的としています。学校の生徒会長を選ぶ選挙や、授業内での模擬選挙などに使ってみてはいかがでしょうか？\n      ")]),t._v(" "),s("p",[t._v("利用できる投票ルール:")]),t._v(" "),s("ul",[s("li",[t._v("多数決")]),t._v(" "),s("li",[t._v("ボルダルール")]),t._v(" "),s("li",[t._v("コンドルセ・ヤングの最尤法")]),t._v(" "),s("li",[t._v("マジョリティ・ジャッジメント")])]),t._v(" "),s("p",[t._v("ErabeRuleの特徴:")]),t._v(" "),s("ul",[s("li",[t._v("アカウント作成は必要ありません。")]),t._v(" "),s("li",[t._v("投票は匿名で行われます。")]),t._v(" "),s("li",[t._v("他の投票ルールを採用していたらどのような結果になっていたかシュミレーションできます。(ボルダルールまたはコンドルセ・ヤングの最尤法の場合)")]),t._v(" "),s("li",[t._v("参加者は一人１回のみ投票できます。")]),t._v(" "),s("li",[t._v("結果はリアルタイムで画面に反映されます。")]),t._v(" "),s("li",[t._v("集計はアプリが自動で計算してくれるので、面倒な集計作業は必要はありません。")])])])}]};var c=s("VU/8")({methods:{start:function(){this.$router.push({path:"attend"})}}},l,!1,function(t){s("Vb6W")},null,null).exports,u=s("Xxa5"),d=s.n(u),h=s("exGp"),p=s.n(h),v=s("yGkR"),m=(s("881v"),{data:function(){return{enteredTitle:this.enteredTitle,attendedRooms:[],showRecentRoomButton:!1,recentlyAttendedRoom:void 0,recentlyAttendedRoomTitle:"",recentlyAttendedRoomId:""}},created:function(){this.getAttendedRooms()},watch:{attendedRooms:function(){this.attendedRooms.length>0&&(this.setRecentRoomButton(this.attendedRooms[0]),this.showRecentRoomButton=!0)}},methods:{getAttendedRooms:function(){var t=p()(d.a.mark(function t(){var e,s,n,a;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=v.a.auth().currentUser.uid,console.log("userId: ",e),s=v.a.firestore(),n=s.collection("users").doc(e),t.next=6,n.get();case 6:return a=t.sent,console.log("userDoc: ",a),t.next=10,a.data().attendedRooms;case 10:return this.attendedRooms=t.sent,t.next=13,console.log("attendedRooms: ",this.attendedRooms);case 13:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),setRecentRoomButton:function(){var t=p()(d.a.mark(function t(e){var s,n,a;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=v.a.firestore(),n=s.collection("rooms").doc(e),t.next=4,n.get();case 4:return a=t.sent,t.next=7,a.data();case 7:return this.recentlyAttendedRoom=t.sent,t.next=10,console.log("recentlyAttendedRoom: ",this.recentlyAttendedRoom);case 10:return t.next=12,this.recentlyAttendedRoom.title;case 12:this.recentlyAttendedRoomTitle=t.sent,this.recentlyAttendedRoomId=e;case 14:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),searchButtonClicked:function(){this.$router.push({name:"roomOutline",query:{enteredTitle:this.enteredTitle,hasVoted:!1,attendedRooms:this.attendedRooms}})},recentRoomButtonClicked:function(){this.$router.push({name:"roomOutline",query:{hasVoted:!0,room:this.recentlyAttendedRoom,docId:this.recentlyAttendedRoomId}})}}}),f={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"search-app"}},[s("div",{staticClass:"home-section"},[s("p",[t._v("ルーム名を検索して投票に参加")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.enteredTitle,expression:"enteredTitle"}],staticClass:"primary-textfield",attrs:{type:"text",placeholder:"ルーム名を入力",id:"search-text-field"},domProps:{value:t.enteredTitle},on:{input:function(e){e.target.composing||(t.enteredTitle=e.target.value)}}}),t._v(" "),s("button",{staticClass:"primary-button",on:{click:t.searchButtonClicked}},[t._v("検索")])]),t._v(" "),t.showRecentRoomButton?s("div",{staticClass:"home-section"},[s("p",[t._v("最近参加したルーム")]),t._v(" "),s("button",{staticClass:"card-button",on:{click:t.recentRoomButtonClicked}},[t._v(t._s(t.recentlyAttendedRoomTitle))])]):t._e()])},staticRenderFns:[]};var _=s("VU/8")(m,f,!1,function(t){s("3d+2")},null,null).exports,g={data:function(){return{showRecentRoomButton:!1,createdRooms:[],recentlyCreatedRoom:void 0,recentlyCreatedRoomTitle:"",recentlyCreatedRoomId:""}},created:function(){this.getCreatedRooms()},watch:{createdRooms:function(){this.createdRooms.length>0&&(this.setRecentRoomButton(this.createdRooms[0]),this.showRecentRoomButton=!0)}},methods:{createButtonClicked:function(){this.$router.push({path:"newroom"})},getCreatedRooms:function(){var t=p()(d.a.mark(function t(){var e,s,n,a;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=v.a.auth().currentUser.uid,console.log("userId: ",e),s=v.a.firestore(),n=s.collection("users").doc(e),t.next=6,n.get();case 6:return a=t.sent,console.log("userDoc: ",a),t.next=10,a.data().createdRooms;case 10:return this.createdRooms=t.sent,t.next=13,console.log("createdRooms: ",this.createdRooms);case 13:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),setRecentRoomButton:function(){var t=p()(d.a.mark(function t(e){var s,n,a;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=v.a.firestore(),n=s.collection("rooms").doc(e),t.next=4,n.get();case 4:return a=t.sent,t.next=7,a.data();case 7:return this.recentlyCreatedRoom=t.sent,t.next=10,console.log("recentlyCreatedRoom: ",this.recentlyCreatedRoom);case 10:return t.next=12,this.recentlyCreatedRoom.title;case 12:this.recentlyCreatedRoomTitle=t.sent,this.recentlyCreatedRoomId=e;case 14:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),recentRoomButtonClicked:function(){this.$router.push({name:"roomSetting",query:{room:this.recentlyCreatedRoom,docId:this.recentlyCreatedRoomId}})}}},R={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"create-app"}},[s("div",{staticClass:"home-section"},[s("p",[t._v("新しい投票ルームを作成")]),t._v(" "),s("button",{staticClass:"primary-button",on:{click:t.createButtonClicked}},[t._v("作成")])]),t._v(" "),t.showRecentRoomButton?s("div",{staticClass:"home-section"},[s("p",[t._v("最近作成したルーム")]),t._v(" "),s("button",{staticClass:"card-button",on:{click:t.recentRoomButtonClicked}},[t._v(t._s(t.recentlyCreatedRoomTitle))])]):t._e()])},staticRenderFns:[]};var x=s("VU/8")(g,R,!1,function(t){s("a+S0")},null,null).exports,k={unsubscribe:null,data:function(){return{title:"",searchingView:!0,roomOutlineView:!1,noResultsView:!1,isClosed:!1,resultView:!1,showScoreLabel:!0,room:[],docId:"",resultTitle:"",arrayOfResults:[],resultRule:"",roomData:void 0,personalRanks:[],numOfVoters:[],isViewOtherResultsActive:!1,otherRulesResults:{}}},created:function(){if(this.$route.query.hasVoted){this.roomData=this.$route.query.room;var t=this.$route.query.docId;this.showResult(this.roomData,t)}else this.showRoomOutline()},destroyed:function(){this.unsubscribe&&(console.log("listener is stopping. ",this.unsubscribe),this.unsubscribe(),this.unsubscribe=null)},watch:{personalRanks:function(){this.reloadResult(this.roomData)}},methods:{goToVoteButtonClicked:function(){this.$router.push({name:"form",query:{room:this.room,docId:this.docId}})},showRoomOutline:function(){var t=p()(d.a.mark(function t(){var e,s,n=this;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=this.$route.query.enteredTitle,this.enteredTitle=e,s=v.a.firestore(),s.collection("rooms").where("title","==",e).get().then(function(t){var e=void 0;console.log("querySnapshot: ",t),t.forEach(function(t){if(n.$route.query.attendedRooms.includes(t.id))return n.roomData=t.data(),void n.showResult(t.data(),t.id);e=t.data(),n.title=e.title,"ongoing"==e.state?(n.searchingView=!1,n.roomOutlineView=!0):"closed"==e.state&&(n.searchingView=!1,n.isClosed=!0),n.room=e,n.docId=t.id}),t.docs.length<=0&&(n.searchingView=!1,n.noResultsView=!0)});case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),showResult:function(t,e){var s=this;this.unsubscribe&&(console.warn("listener is running. ",this.unsubscribe),this.unsubscribe(),this.unsubscribe=null);var n=v.a.firestore().collection("rooms").doc(e).collection("votes");this.unsubscribe=n.onSnapshot(function(t){var e=[];t.docChanges().forEach(function(t){"added"===t.type&&e.push(t.doc.data().personalRank)}),s.personalRanks=s.personalRanks.concat(e),s.numOfVoters=t.docs.length,console.log("personalRanks",s.personalRanks)}),this.reloadResult(t)},reloadResult:function(t){if(this.unsubscribe){switch(this.resultTitle=t.title,this.enteredTitle=t.title,t.rule){case"majorityRule":this.arrayOfResults=this.majorityRule(this.personalRanks,t);break;case"bordaRule":this.arrayOfResults=this.bordaRule(this.personalRanks,t),this.otherRulesResults={majorityRule:[],condorcetRule:[]},this.otherRulesResults.majorityRule=this.majorityRule(this.personalRanks,t);var e=this.condorcetRule(this.personalRanks,t);this.otherRulesResults.condorcetRule=this.removeDuplication(e),console.log("otherRulesResults",this.otherRulesResults);break;case"condorcetRule":this.showScoreLabel=!1;var s=this.condorcetRule(this.personalRanks,t);this.arrayOfResults=this.removeDuplication(s),this.otherRulesResults={majorityRule:[],bordaRule:[]},this.otherRulesResults.majorityRule=this.majorityRule(this.personalRanks,t),this.otherRulesResults.bordaRule=this.bordaRule(this.personalRanks,t),console.log("otherRulesResults",this.otherRulesResults);break;case"majorityJudgement":this.arrayOfResults=this.majorityJudgement(this.personalRanks,t),this.otherRulesResults={averageScore:[]},this.otherRulesResults.averageScore=this.averageScore(this.personalRanks,t),console.log("otherRulesResults",this.otherRulesResults)}this.resultRule=this.convertRuleNameToDisplayName(t.rule),"ongoing"==t.state?(this.searchingView=!1,this.resultView=!0):"closed"==t.state&&(this.searchingView=!1,this.isClosed=!0),console.log("personalRanks: ",this.personalRanks)}},removeDuplication:function(t){var e=t.map(function(t){for(var e="",s=0;s<t.length;s++){var n=t[s];e+=n.name+n.arrayIndex}return e});console.log("optionNames: ",e);for(var s=[t[0]],n=0;n<t.length;n++)for(var a=0;a<n&&0!==n;a++){if(e[n]===e[a])break;a===n-1&&s.push(t[n])}return s},toggleViewOtherRules:function(){this.isViewOtherResultsActive?this.isViewOtherResultsActive=!1:this.isViewOtherResultsActive=!0},majorityRule:function(t,e){for(var s=[],n=0;n<e.options.length;n++)s.push({name:e.options[n],score:0,rank:0});for(var a=0;a<t.length;a++){s[t[a].findIndex(function(t){return 1==t})].score+=1}s.sort(function(t,e){return e.score-t.score});for(var o=0;o<s.length;o++)s[o].rank=o+1;for(var r=0;r<s.length&&r!=s.length-1;r++)s[r].score==s[r+1].score&&(s[r+1].rank=s[r].rank);for(var i=[],l=0;l<s.length;l++){var c=s[l];i.push({name:c.name,score:c.score.toString()+"票",rank:c.rank.toString()+"位"})}return[i]},bordaRule:function(t,e){for(var s=[],n=0;n<e.options.length;n++)s.push({name:e.options[n],score:0,rank:0});for(var a=0;a<t.length;a++)for(var o=t[a],r=0;r<o.length;r++){var i=o.length-o[r]+1;s[r].score+=i}s.sort(function(t,e){return e.score-t.score});for(var l=0;l<s.length;l++)s[l].rank=l+1;for(var c=0;c<s.length&&c!=s.length-1;c++)s[c].score==s[c+1].score&&(s[c+1].rank=s[c].rank);for(var u=[],d=0;d<s.length;d++){var h=s[d];u.push({name:h.name,score:h.score.toString()+"点",rank:h.rank.toString()+"位"})}return[u]},condorcetRule:function(t,e){for(var s=e.options.length,n=[],a=0;a<s;a++)n.push({arrayIndex:a,name:e.options[a],score:0,rank:0});console.log(s);for(var o=[],r=2*s*(s-1)/2,i=0;i<r;i++)o.push(0);for(var l=0;l<t.length;l++)for(var c=t[l],u=0;u<s;u++)for(var d=0;d<s;d++){var h=d+u+1;if(h>s-1)break;if(c[u]<c[h])o[this.nArrayIndex(u,h,s)]+=1;else o[this.nArrayIndex(h,u,s)]+=1}console.log("nArray",o);var p=this.pArrayElementsCalculate(s);console.log(p);for(var v=[],m=this.factorial(s),f=0;f<m;f++)v.push(0);for(var _=0;_<m;_++){for(var g=p[_],R=[],x=0;x<s;x++)for(var k=0;k<s;k++){var C=k+x+1;if(C>s-1)break;var y=this.nArrayIndex(g[x],g[C],s);R.push(o[y])}for(var b=0;b<R.length;b++)v[_]+=R[b]}console.log("pArray",v);for(var w=[0],E=0;E<v.length&&E!==v.length-1;E++){var A=w[0];v[A]<v[E+1]?(w=[]).push(E+1):v[A]===v[E+1]&&w.push(E+1)}for(var I=[],S=0;S<w.length;S++)I.push(p[w[S]]);console.log("maxPElements",I);for(var j=[],O=0;O<I.length;O++){for(var V=I[O],D=0;D<s;D++)n[D].rank=V[D]+1;console.log("results",n),n.sort(function(t,e){return t.rank-e.rank}),console.log("results",n);for(var T=0;T<n.length;T++){n[T].rank+="位"}j.push(n.slice())}return console.log("arrayOfResults: ",j),j},nArrayIndex:function(t,e,s){return t<e?(s-1)*t+e-1:(s-1)*t+(e+1)-1},pArrayElementsCalculate:function(t){for(var e=[],s=Math.pow(t,t),n=0;n<s;n++){for(var a=[],o=0;o<t;o++)a.push(0);for(var r=Number(n.toString(t)),i=0;i<t;i++)a[t-1-i]=r%10,r=Math.floor(r/10);a.filter(function(t,e,s){return s.indexOf(t)===e}).length===t&&e.push(a)}return e},factorial:function(t){return 0===t?1:t*this.factorial(t-1)},compareRanks:function(t,e){var s=t.rank,n=e.rank,a=0;return s>n?a=1:s<n&&(a=-1),a},majorityJudgement:function(t,e){for(var s=[],n=0;n<e.options.length;n++)s.push({name:e.options[n],score:0,rank:0});for(var a=[],o=function(e){var n=t.map(function(t){return t[e]});n.sort(function(t,e){return t-e});var o=void 0;if(n.length%2==1)o=n[Math.floor(n.length/2)];else{var r=n[Math.floor(n.length/2)];o=r}s[e].score=o,console.log("medianEvaluation",o);var i=n.filter(function(t){return t<=o});a.push(i.length)},r=0;r<e.options.length;r++)o(r);console.log("tieBreakingEvaluations: ",a),console.log("results: ",s);for(var i=0;i<s.length;i++)if(0!==i)for(var l=0;l<i;l++)s[l].score>s[i].score?s=this.swapAt(s,l,i):s[l].score===s[i].score&&(a[l]<a[i]?s=this.swapAt(s,l,i):a[l]===a[i]&&(s[l].rank=-s[l].score,s[i].rank=-s[l].score));for(var c=[],u=0;u<s.length;u++)console.log("results[i].score",s[u].score),c.push({name:s[u].name,score:s[u].score,rank:0});for(var d=0;d<s.length;d++)0!==d?s[d].rank===-s[d].score&&s[d-1].rank==-s[d].score?c[d].rank=c[d-1].rank:c[d].rank=c[d-1].rank+1:c[d].rank=1;for(var h=[],p=0;p<s.length;p++)console.log("results[i].score",s[p].score),h.push({name:c[p].name,score:c[p].score,rank:c[p].rank.toString()+"位"});return console.log("majorityJudgement: ",h),[h]},swapAt:function(t,e,s){return elementI=t[e],elementJ=t[s],t[e]=elementJ,t[s]=elementI,t},averageScore:function(t,e){for(var s=[],n=0;n<e.options.length;n++)s.push({name:e.options[n],score:0,rank:0});for(var a=e.commonLanguage.length,o=0;o<t.length;o++)for(var r=t[o],i=0;i<r.length;i++){var l=a-(r[i]-1);s[i].score+=l}for(var c=0;c<s.length;c++){var u=s[c].score/t.length,d=Math.round(10*u)/10;s[c].score=d}console.log("average: ",s),s.sort(function(t,e){return e.score-t.score});for(var h=0;h<s.length;h++)s[h].rank=h+1;for(var p=0;p<s.length&&p!=s.length-1;p++)s[p].score==s[p+1].score&&(s[p+1].rank=s[p].rank);for(var v=[],m=0;m<s.length;m++){var f=s[m];v.push({name:f.name,score:f.score.toString()+"/"+a,rank:f.rank.toString()+"位"})}return[v]},convertRuleNameToDisplayName:function(t){switch(t){case"majorityRule":return"多数決";case"bordaRule":return"ボルダルール";case"condorcetRule":return"コンドルセ・ヤングの最尤法";case"majorityJudgement":return"マジョリティ・ジャッジメント";default:return""}}}},C={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"body-padding",attrs:{id:"room-outline"}},[s("div",{staticClass:"content"},[t.searchingView?s("div",{staticClass:"result-section"},[s("p",{staticClass:"primary-text"},[t._v("検索中...")])]):t._e(),t._v(" "),t.roomOutlineView?s("div",{staticClass:"result-section"},[s("p",{staticClass:"text-left supporting-text"},[t._v("タイトル")]),t._v(" "),s("p",{staticClass:"text-left primary-text"},[t._v(t._s(t.title))]),t._v(" "),s("button",{staticClass:"primary-button",on:{click:t.goToVoteButtonClicked}},[t._v("\n        投票する\n      ")])]):t._e(),t._v(" "),t.noResultsView?s("div",{staticClass:"result-section"},[s("p",{staticClass:"primary-text"},[t._v('"'+t._s(t.enteredTitle)+'":'),s("br"),t._v("該当なし")])]):t._e(),t._v(" "),t.isClosed?s("div",{staticClass:"result-section"},[s("p",{staticClass:"primary-text"},[t._v('"'+t._s(t.enteredTitle)+'"は非公開です。')])]):t._e(),t._v(" "),t.resultView?s("div",{staticClass:"result-section text-right"},[t._m(0),t._v(" "),s("div",{staticClass:"result-small-section"},[s("p",{staticClass:"text-left supporting-text"},[t._v("タイトル")]),t._v(" "),s("p",{staticClass:"text-left primary-text"},[t._v(t._s(t.resultTitle))])]),t._v(" "),s("div",{staticClass:"result-small-section"},[s("p",{staticClass:"text-left supporting-text"},[t._v("結果")]),t._v(" "),t._l(t.arrayOfResults,function(e,n,a){return s("ul",{key:a},[t.arrayOfResults.length>1?s("p",{staticClass:"text-left supporting-text"},[t._v("\n            "+t._s(n+1)+"つ目の可能性\n          ")]):t._e(),t._v(" "),"majorityJudgement"!==t.roomData.rule?s("div",t._l(e,function(e,n){return s("li",{key:n,staticClass:"text-left primary-text results-table"},[s("span",{staticClass:"rank-label"},[t._v(t._s(e.rank))]),t._v(" "),s("span",{staticClass:"optionname-label"},[t._v(t._s(e.name))]),t._v(" "),t.showScoreLabel?s("span",{staticClass:"score-label"},[t._v("\n                "+t._s(e.score)+"\n              ")]):s("span")])}),0):s("div",t._l(e,function(e,n){return s("li",{key:n,staticClass:"text-left primary-text results-table"},[s("span",{staticClass:"rank-label"},[t._v(t._s(e.rank))]),t._v(" "),s("span",[s("span",{staticClass:"optionname-label"},[t._v(t._s(e.name))]),t._v(" "),s("p",{staticClass:"optionname-label"},[t._v("\n                  "+t._s(t.roomData.commonLanguage[e.score-1])+"\n                ")])]),t._v(" "),s("span")])}),0),t._v(" "),s("p",{staticClass:"text-right supporting-text"},[t._v("\n            "+t._s(t.numOfVoters)+"人が投票済み\n          ")])])})],2),t._v(" "),s("div",{staticClass:"result-small-section"},[s("p",{staticClass:"text-left supporting-text"},[t._v("投票のルール")]),t._v(" "),s("p",{staticClass:"text-left primary-text"},[t._v("\n          この投票は"+t._s(t.resultRule)+"で集計されました。\n        ")])]),t._v(" "),s("div",{staticClass:"result-small-section"},["majorityRule"!==t.roomData.rule?s("div",{staticClass:"text-left"},[t.isViewOtherResultsActive?s("div",[void 0!==t.otherRulesResults.majorityRule?s("div",t._l(t.otherRulesResults.majorityRule,function(e,n){return s("ul",{key:n},[s("p",[t._v("もし多数決だったら")]),t._v(" "),t._l(e,function(e,n){return s("li",{key:n,staticClass:"text-left primary-text results-table"},[s("span",{staticClass:"rank-label"},[t._v(t._s(e.rank))]),t._v(" "),s("span",{staticClass:"optionname-label"},[t._v(t._s(e.name))]),t._v(" "),s("span",{staticClass:"score-label"},[t._v(t._s(e.score))])])})],2)}),0):t._e(),t._v(" "),void 0!==t.otherRulesResults.bordaRule?s("div",t._l(t.otherRulesResults.bordaRule,function(e,n){return s("ul",{key:n},[s("p",[t._v("もしボルダルールだったら")]),t._v(" "),t._l(e,function(e,n){return s("li",{key:n,staticClass:"text-left primary-text results-table"},[s("span",{staticClass:"rank-label"},[t._v(t._s(e.rank))]),t._v(" "),s("span",{staticClass:"optionname-label"},[t._v(t._s(e.name))]),t._v(" "),s("span",{staticClass:"score-label"},[t._v(t._s(e.score))])])})],2)}),0):t._e(),t._v(" "),void 0!==t.otherRulesResults.condorcetRule?s("div",t._l(t.otherRulesResults.condorcetRule,function(e,n,a){return s("ul",{key:a},[s("p",{staticClass:"text-left supporting-text"},[t._v("\n                  もしコンドルセ・ヤングの最尤法だったら\n                  "),t.otherRulesResults.condorcetRule.length>1?s("span",[t._v("\n                    ("+t._s(n+1)+"つ目の可能性)\n                  ")]):t._e()]),t._v(" "),t._l(e,function(e,n){return s("li",{key:n,staticClass:"text-left primary-text results-table"},[s("span",{staticClass:"rank-label"},[t._v(t._s(e.rank))]),t._v(" "),s("span",{staticClass:"optionname-label"},[t._v(t._s(e.name))]),t._v(" "),s("span",{staticClass:"score-label"})])})],2)}),0):t._e(),t._v(" "),void 0!==t.otherRulesResults.averageScore?s("div",t._l(t.otherRulesResults.averageScore,function(e,n){return s("ul",{key:n},[s("p",[t._v("もし平均を使っていたら")]),t._v(" "),t._l(e,function(e,n){return s("li",{key:n,staticClass:"text-left primary-text results-table"},[s("span",{staticClass:"rank-label"},[t._v(t._s(e.rank))]),t._v(" "),s("span",[s("span",{staticClass:"optionname-label"},[t._v(t._s(e.name))]),t._v(" "),s("p",{staticClass:"optionname-label"},[t._v("\n                      "+t._s(e.score)+"\n                    ")])]),t._v(" "),s("span")])})],2)}),0):t._e()]):t._e(),t._v(" "),s("button",{staticClass:"text-button",on:{click:t.toggleViewOtherRules}},[t.isViewOtherResultsActive?s("div",[t._v("結果の検証を非表示")]):s("div",[t._v("結果の検証を表示")])])]):t._e()])]):t._e()])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"small-loading-section"},[e("div",{staticClass:"small-loading-container inlineblock"},[e("div",{staticClass:"small-loading-b"}),this._v(" "),e("div",{staticClass:"small-loading-f"})]),this._v(" "),e("p",{staticClass:"supporting-text inlineblock margin-zero-p"},[this._v("ライブ")])])}]};var y=s("VU/8")(k,C,!1,function(t){s("UM69")},null,null).exports,b={data:function(){return{roomData:[],docId:"",title:"",hasExplanation:!1,explanation:"",options:[],mjOptions:[],isCheckBoxStyle:!0,showRankLabel:!0,rule:"",personalRank:[],isFormFilled:!1,showForm:!0,showResultView:!1}},created:function(){this.roomData=this.$route.query.room,this.docId=this.$route.query.docId,this.title=this.roomData.title,""!=this.roomData.explanation&&(this.explanation=this.roomData.explanation,this.hasExplanation=!0);for(var t=0;t<this.roomData.options.length;t++)this.options.push({name:this.roomData.options[t],index:t,checked:!1,personalRank:0}),this.personalRank.push(0);if("majorityJudgement"==this.roomData.rule)for(var e=0;e<this.roomData.options.length;e++){for(var s=this.roomData.commonLanguage,n=[],a=0;a<s.length;a++)n.push({commonLanguage:s[a],checked:!1});this.mjOptions.push({name:this.roomData.options[e],evaluationLanguage:n})}"majorityRule"==this.roomData.rule&&(this.isCheckBoxStyle=!1,this.showRankLabel=!1),this.rule=this.convertRuleNameToDisplayName(this.roomData.rule)},methods:{changed:function(t){this.makeMultiSelection(t)},radioChecked:function(t){this.makeSingleSelection(t)},mjRadioChecked:function(t,e){this.mjOptions[t].evaluationLanguage[e].checked=!this.mjOptions[t].evaluationLanguage[e].checked;for(var s=0;s<this.mjOptions[t].evaluationLanguage.length;s++)s!=e&&(this.mjOptions[t].evaluationLanguage[s].checked=!1);this.makeMjSelection(t,e)},makeSingleSelection:function(t){if(0==this.personalRank[t.index]){var e=void 0;console.log("options",this.options);for(var s=0;s<this.options.length;s++)if(1==this.options[s].personalRank){e=this.options[s];break}console.log("selectedOption",e),void 0!=e?(document.getElementById(e.name+e.index).checked=!1,document.getElementById(t.name+t.index).checked=!0,this.personalRank[e.index]=0,this.personalRank[t.index]=1,this.options[e.index].personalRank=0,this.options[t.index].personalRank=1):(document.getElementById(t.name+t.index).checked=!0,this.personalRank[t.index]=1,this.options[t.index].personalRank=1)}else document.getElementById(t.name+t.index).checked=!1,this.personalRank[t.index]=0,this.options[t.index].personalRank=0;console.log(this.personalRank),1==this.personalRank.filter(function(t){return 0!=t}).length?this.isFormFilled=!0:this.isFormFilled=!1},makeMultiSelection:function(t){if(0==this.personalRank[t.index]){var e=this.personalRank.filter(function(t){return 0!=t});this.personalRank[t.index]=e.length+1}else{for(var s=0;s<this.personalRank.length;s++)this.personalRank[s]>this.personalRank[t.index]&&(this.personalRank[s]-=1);this.personalRank[t.index]=0}for(var n=0;n<this.personalRank.length;n++)this.options[n].personalRank=this.personalRank[n];console.log(this.personalRank),this.personalRank.filter(function(t){return 0!=t}).length==this.personalRank.length?this.isFormFilled=!0:this.isFormFilled=!1},makeMjSelection:function(t,e){var s=e+1,n=this.personalRank[t];this.personalRank[t]=n==s?0:s,console.log(this.personalRank),this.personalRank.filter(function(t){return 0!=t}).length==this.personalRank.length?this.isFormFilled=!0:this.isFormFilled=!1},send:function(){console.log("docId: ",this.docId);var t=v.a.firestore().collection("rooms").doc(this.docId).collection("votes").doc(),e=this.docId;t.set({personalRank:this.personalRank,date:new Date}).then(function(){var t=v.a.firestore(),s=v.a.auth().currentUser.uid;console.log("userId: ",s);var n=t.collection("users").doc(s);n.get().then(function(t){var s=[];if(t.exists){var a=t.data();a.attendedRooms!=[]?((s=a.attendedRooms).unshift(e),n.update({attendedRooms:s,date:new Date}).then(function(){console.log("Successfully updated data"),!0}).catch(function(t){console.error("Error writing document: ",t)}),console.log("returning")):(s=[e],n.set({attendedRooms:s,createdRooms:[],date:new Date}).then(function(){console.log("Successfully set data"),!0}).catch(function(t){console.error("Error writing document: ",t)}),console.log("new"))}else s=[e],n.set({attendedRooms:s,createdRooms:[],date:new Date}).then(function(){console.log("Successfully set data"),!0}).catch(function(t){console.error("Error writing document: ",t)}),console.log("unknown")}).catch(function(t){console.error("Error getting document: ",t)})}).catch(function(t){console.error("Error writing document: ",t)}),this.showForm=!1,this.showResultView=!0},goToResult:function(){this.$router.push({name:"roomOutline",query:{hasVoted:!0,room:this.roomData,docId:this.docId}})},convertRuleNameToDisplayName:function(t){switch(t){case"majorityRule":return"多数決";case"bordaRule":return"ボルダルール";case"condorcetRule":return"コンドルセ・ヤングの最尤法";case"majorityJudgement":return"マジョリティ・ジャッジメント";default:return""}}}},w={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"body-padding",attrs:{id:"form"}},[s("div",{staticClass:"content"},[s("div",{staticClass:"result-section"},[s("div",{staticClass:"result-small-section"},[s("p",{staticClass:"text-left supporting-text"},[t._v("タイトル")]),t._v(" "),s("p",{staticClass:"text-left primary-text"},[t._v(t._s(t.title))])]),t._v(" "),t.showForm?s("div",[s("div",{staticClass:"result-small-section"},[t.hasExplanation?s("p",{staticClass:"text-left supporting-text"},[t._v("説明")]):t._e(),t._v(" "),t.hasExplanation?s("p",{staticClass:"text-left primary-text"},[t._v(t._s(t.explanation))]):t._e()]),t._v(" "),"majorityJudgement"!=t.roomData.rule?s("div",[s("div",{staticClass:"result-small-section"},["majorityRule"==t.roomData.rule?s("p",{staticClass:"text-left supporting-text"},[t._v("選択肢")]):s("p",{staticClass:"text-left supporting-text"},[t._v("選択肢（支持する順に選んで順位をつけます。）")]),t._v(" "),s("ul",t._l(t.options,function(e){return s("li",{staticClass:"text-left primary-text results-table"},[t.isCheckBoxStyle?s("input",{directives:[{name:"model",rawName:"v-model",value:e.checked,expression:"option.checked"}],attrs:{type:"checkbox",id:e.name+e.index},domProps:{checked:Array.isArray(e.checked)?t._i(e.checked,null)>-1:e.checked},on:{change:[function(s){var n=e.checked,a=s.target,o=!!a.checked;if(Array.isArray(n)){var r=t._i(n,null);a.checked?r<0&&t.$set(e,"checked",n.concat([null])):r>-1&&t.$set(e,"checked",n.slice(0,r).concat(n.slice(r+1)))}else t.$set(e,"checked",o)},function(s){return t.changed(e)}]}}):t._e(),t._v(" "),t.isCheckBoxStyle?t._e():s("input",{directives:[{name:"model",rawName:"v-model",value:e.checked,expression:"option.checked"}],attrs:{type:"radio",id:e.name+e.index},domProps:{checked:t._q(e.checked,null)},on:{click:function(s){return t.radioChecked(e)},change:function(s){return t.$set(e,"checked",null)}}}),t._v(" "),s("label",{staticClass:"optionname-label",class:t.isCheckBoxStyle?"primary-checkbox":"primary-radio",attrs:{for:e.name+e.index}},[t._v(t._s(e.name))]),t._v(" "),t.showRankLabel&&0!=e.personalRank?s("label",{staticClass:"personalrank-label",attrs:{for:e.name+e.index}},[t._v(t._s(e.personalRank))]):t._e()])}),0)])]):s("div",t._l(t.options,function(e,n){return s("div",{staticClass:"result-small-section"},[s("p",{staticClass:"text-left supporting-text"},[t._v("選択肢"+t._s(n+1))]),t._v(" "),s("p",{staticClass:"text-left primary-text optionname-label"},[t._v(t._s(e.name))]),t._v(" "),s("ul",t._l(t.roomData.commonLanguage,function(a,o){return s("li",{staticClass:"text-left primary-text results-table"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.mjOptions[n].evaluationLanguage[o].checked,expression:"mjOptions[i].evaluationLanguage[j].checked"}],attrs:{type:"radio",id:e.name+n.toString()+a+o.toString()},domProps:{checked:t._q(t.mjOptions[n].evaluationLanguage[o].checked,null)},on:{click:function(e){return t.mjRadioChecked(n,o)},change:function(e){return t.$set(t.mjOptions[n].evaluationLanguage[o],"checked",null)}}}),t._v(" "),s("label",{staticClass:"primary-radio optionname-label",attrs:{for:e.name+n.toString()+a+o.toString()}},[t._v(t._s(a))])])}),0)])}),0),t._v(" "),s("div",{staticClass:"result-small-section"},[s("p",{staticClass:"text-left supporting-text"},[t._v("この投票は"+t._s(t.rule)+"で集計されます。")])]),t._v(" "),s("div",{staticClass:"result-small-section"},[s("button",{staticClass:"primary-button",attrs:{disabled:!t.isFormFilled},on:{click:t.send}},[t._v("送信")])])]):t._e()]),t._v(" "),s("div",{staticClass:"result-section"},[t.showResultView?s("div",[s("p",{staticClass:"text-left"},[t._v("投票済み")]),t._v(" "),s("button",{staticClass:"primary-button",on:{click:t.goToResult}},[t._v("結果を見る")])]):t._e()])])])},staticRenderFns:[]};var E=s("VU/8")(b,w,!1,function(t){s("P2r2")},null,null).exports,A=s("//Fk"),I=s.n(A),S={data:function(){return{enteredTitle:this.enteredTitle,shouldChangeTitle:!1,enteredExplanation:this.enteredExplanation,enteredOptions:[{text:""}],selectedRule:"",hasAddedExplanation:!1,isFormFilled:!1,hasPosted:!1,rulesArray:[{index:0,name:"majorityRule",displayName:"多数決",explanation:"通常の多数決です。",checked:!1},{index:1,name:"bordaRule",displayName:"ボルダルール",explanation:"選択肢が３つ以上の時に使えます。例えば３択の時、１番良いと思う候補に３点、２番目に２点、３番目に１点を加算します。勝者は満場一致に最も近いものになります。",checked:!1},{index:2,name:"condorcetRule",displayName:"コンドルセ・ヤングの最尤法",explanation:"選択肢が３つ以上の時に使えます。総当たり戦を元に確率の計算を行います。勝者は他の候補との一騎打ちで必ず勝利します。",checked:!1},{index:3,name:"majorityJudgement",displayName:"マジョリティ・ジャッジメント",explanation:"各選択肢に対して絶対評価で投票し、中央値をその候補の評価とします。",checked:!1}],commonLanguage:[{text:"非常に良い"},{text:"良い"},{text:"まずまず"},{text:"容認"},{text:"不十分"},{text:"失格"}]}},watch:{enteredTitle:function(){this.isFormFilled=this.checkIfFormIsFilled()},enteredOptions:{handler:function(){this.isFormFilled=this.checkIfFormIsFilled(),console.log("enteredOptions: ",this.enteredOptions)},deep:!0},selectedRule:function(){this.isFormFilled=this.checkIfFormIsFilled()},commonLanguage:{handler:function(){this.isFormFilled=this.checkIfFormIsFilled(),console.log("commonLanguage: ",this.commonLanguage)},deep:!0}},methods:{addExplanation:function(){this.hasAddedExplanation=!0},addOption:function(){this.enteredOptions=this.removeBlanks(this.enteredOptions),this.enteredOptions.push({text:""})},addLanguage:function(){this.commonLanguage=this.removeBlanks(this.commonLanguage),this.commonLanguage.push({text:""})},removeBlanks:function(t){for(var e=[],s=0;s<t.length;s++)""!=t[s].text&&e.push(t[s]);return e},radioChecked:function(t){if(t.checked)document.getElementById(t.name).checked=!1,this.rulesArray[t.index].checked=!1;else{for(var e=void 0,s=0;s<this.rulesArray.length;s++)if(1==this.rulesArray[s].checked){e=this.rulesArray[s];break}void 0!=e?(document.getElementById(e.name).checked=!1,document.getElementById(t.name).checked=!0,this.rulesArray[e.index].checked=!1,this.rulesArray[t.index].checked=!0):(document.getElementById(t.name).checked=!0,this.rulesArray[t.index].checked=!0)}this.selectedRule=this.findSelectedRule(),console.log("selectedRuleL ",this.selectedRule)},findSelectedRule:function(){for(var t=void 0,e=0;e<this.rulesArray.length;e++)if(1==this.rulesArray[e].checked){t=this.rulesArray[e].name;break}return t},deleteLanguage:function(t){var e=this.commonLanguage.findIndex(function(e,s,n){return e.text==t});this.commonLanguage.splice(e,1)},checkIfFormIsFilled:function(){var t=!0;return void 0!=this.enteredTitle&&""!=this.enteredTitle||(t=!1),0==this.removeBlanks(this.enteredOptions).length&&(t=!1),""!=this.selectedRule&&void 0!=this.selectedRule||(t=!1),0==this.removeBlanks(this.commonLanguage).length&&(t=!1),t},sendButtonClicled:function(){console.log("enteredTitle: ",this.enteredTitle),console.log("enteredExplanation: ",this.enteredExplanation),console.log("selectedRule: ",this.selectedRule);var t=this.generateOptionsArray(),e=this.generateCommonLanguage(),s="";s=void 0==this.enteredExplanation?"":this.enteredExplanation,console.log("explanation: ",s),this.send(t,s,e)},generateOptionsArray:function(){for(var t=[],e=0;e<this.enteredOptions.length;e++){var s=this.enteredOptions[e].text;""!=s&&t.push(s)}return t},generateCommonLanguage:function(){for(var t=[],e=0;e<this.commonLanguage.length;e++){var s=this.commonLanguage[e].text;""!=s&&t.push(s)}return t},send:function(t,e,s){var n=this,a=this.enteredTitle,o=v.a.firestore();o.collection("rooms").where("title","==",a).get().then(function(a){var r=void 0;if(a.forEach(function(t){r=t.data()}),void 0!=r)n.shouldChangeTitle=!0;else{n.shouldChangeTitle=!1;var i=o.collection("rooms").doc(),l=i.id;console.log("newRoomId: ",l);var c=v.a.auth().currentUser.uid;console.log("userId: ",c);var u=void 0;u="majorityJudgement"==n.selectedRule?{title:n.enteredTitle,explanation:e,options:t,commonLanguage:s,rule:n.selectedRule,state:"ongoing",senderId:c,date:new Date}:{title:n.enteredTitle,explanation:e,options:t,rule:n.selectedRule,state:"ongoing",senderId:c,date:new Date},console.log("dataObject: ",u),i.set(u).then(function(){var t=o.collection("users").doc(c);t.get().then(function(e){var s=[];if(e.exists){var n=e.data();n.createdRooms!=[]?((s=n.createdRooms).unshift(l),t.update({createdRooms:s,date:new Date}).then(function(){console.log("Successfully updated data")}).catch(function(t){console.error("Error writing document: ",t)}),console.log("returning")):(s=[l],t.set({attendedRooms:[],createdRooms:s,date:new Date}).then(function(){console.log("Successfully set data")}).catch(function(t){console.error("Error writing document: ",t)}),console.log("new"))}else s=[l],t.set({attendedRooms:[],createdRooms:s,date:new Date}).then(function(){console.log("Successfully set data")}).catch(function(t){console.error("Error writing document: ",t)}),console.log("unknown")}).catch(function(t){console.error("Error getting document: ",t)})}).catch(function(t){console.error("Error writing document: ",t)}),n.hasPosted=!0}})},adjustHeight:function(){var t=this.$refs.adjust_textarea;new I.a(function(e){e(t.style.height="auto")}).then(function(){t.style.height=t.scrollHeight+"px"})}}},j={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"body-padding",attrs:{id:"newroom-app"}},[s("div",{staticClass:"content"},[t.hasPosted?t._e():s("div",{staticClass:"result-section"},[s("div",{staticClass:"result-small-section"},[s("p",{staticClass:"text-left supporting-text"},[t._v("タイトル")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.enteredTitle,expression:"enteredTitle"}],staticClass:"primary-textfield newroom-textfield",attrs:{type:"text",placeholder:"タイトルを入力"},domProps:{value:t.enteredTitle},on:{input:function(e){e.target.composing||(t.enteredTitle=e.target.value)}}}),t._v(" "),t.shouldChangeTitle?s("p",{staticClass:"text-left supporting-text error-color"},[t._v("すでに使われているタイトルです。末尾に数字をつけるなどしてみてください。")]):t._e()]),t._v(" "),s("div",{staticClass:"result-small-section"},[s("p",{staticClass:"text-left supporting-text"},[t._v("説明")]),t._v(" "),s("div",{staticClass:"text-left"},[t.hasAddedExplanation?t._e():s("button",{staticClass:"text-button",on:{click:t.addExplanation}},[t._v("説明文を追加")])]),t._v(" "),t.hasAddedExplanation?s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.enteredExplanation,expression:"enteredExplanation"}],ref:"adjust_textarea",staticClass:"primary-textfield newroom-textfield",attrs:{type:"text",placeholder:"説明文を入力"},domProps:{value:t.enteredExplanation},on:{keydown:t.adjustHeight,input:function(e){e.target.composing||(t.enteredExplanation=e.target.value)}}}):t._e()]),t._v(" "),s("div",{staticClass:"result-small-section"},[s("p",{staticClass:"text-left supporting-text"},[t._v("選択肢")]),t._v(" "),s("ul",[t._l(t.enteredOptions,function(e){return s("li",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.text,expression:"option.text"}],staticClass:"primary-textfield newroom-textfield",attrs:{type:"text",placeholder:"選択肢を入力"},domProps:{value:e.text},on:{input:function(s){s.target.composing||t.$set(e,"text",s.target.value)}}})])}),t._v(" "),s("div",{staticClass:"text-left"},[s("button",{staticClass:"text-button",on:{click:t.addOption}},[t._v("選択肢を追加")])])],2)]),t._v(" "),s("div",{staticClass:"result-small-section"},[s("p",{staticClass:"text-left supporting-text"},[t._v("投票のルールを選択")]),t._v(" "),s("ul",t._l(t.rulesArray,function(e){return s("li",{staticClass:"selectrule-table"},[s("input",{attrs:{type:"radio",id:e.name},on:{click:function(s){return t.radioChecked(e)}}}),t._v(" "),s("label",{staticClass:"primary-radio",attrs:{for:e.name}},[t._v(t._s(e.displayName))]),t._v(" "),e.checked?s("p",{staticClass:"rule-explanation"},[t._v(t._s(e.explanation))]):t._e()])}),0)]),t._v(" "),"majorityJudgement"==t.selectedRule?s("div",{staticClass:"result-small-section"},[s("p",{staticClass:"text-left supporting-text"},[t._v("評価の語彙(良い方から順に入力)")]),t._v(" "),s("ul",[t._l(t.commonLanguage,function(e){return s("li",{staticClass:"selectrule-table"},[s("div",{staticClass:"common-language"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.text,expression:"language.text"}],staticClass:"primary-textfield newroom-textfield",attrs:{type:"text",placeholder:"評価の語彙を入力"},domProps:{value:e.text},on:{input:function(s){s.target.composing||t.$set(e,"text",s.target.value)}}}),t._v(" "),s("button",{staticClass:"delete-button",on:{click:function(s){return t.deleteLanguage(e.text)}}})])])}),t._v(" "),s("div",{staticClass:"text-left"},[s("button",{staticClass:"text-button",on:{click:t.addLanguage}},[t._v("評価の語彙を追加")])])],2)]):t._e(),t._v(" "),t._m(0),t._v(" "),s("div",{staticClass:"result-small-section"},[s("button",{staticClass:"primary-button",attrs:{disabled:!t.isFormFilled},on:{click:t.sendButtonClicled}},[t._v("公開")])])]),t._v(" "),t.hasPosted?s("div",{staticClass:"result-section"},[s("p",{staticClass:"text-left primary-text"},[t._v("公開済み")])]):t._e()])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"result-small-section"},[e("p",{staticClass:"text-left supporting-text"},[this._v("参加者は投票ルームのタイトルを入力することで検索できます。")])])}]};var O=s("VU/8")(S,j,!1,function(t){s("VVw5")},null,null).exports,V={data:function(){return{room:{},docId:"",rule:"",shouldbePublic:!0,hasEdited:!1,hasSaved:!1}},created:function(){this.room=this.$route.query.room,this.docId=this.$route.query.docId,this.rule=this.convertRuleNameToDisplayName(this.room.rule),"ongoing"==this.room.state?this.shouldbePublic=!0:this.shouldbePublic=!1},methods:{changed:function(){this.shouldbePublic=!this.shouldbePublic,console.log("shouldBePublic: ",this.shouldbePublic),this.hasEdited=!this.hasEdited},post:function(){var t="ongoing";t=this.shouldbePublic?"ongoing":"closed",v.a.firestore().collection("rooms").doc(this.docId).update({state:t,date:new Date}).then(function(){console.log("Successfully updated data")}).catch(function(t){console.error("Error writing document: ",t)}),this.hasSaved=!0},convertRuleNameToDisplayName:function(t){switch(t){case"majorityRule":return"多数決";case"bordaRule":return"ボルダルール";case"condorcetRule":return"コンドルセ・ヤングの最尤法";case"majorityJudgement":return"マジョリティ・ジャッジメント";default:return""}}}},D={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"body-padding",attrs:{id:"roomsetting-app"}},[s("div",{staticClass:"content"},[s("div",{staticClass:"result-section"},[s("div",{staticClass:"result-small-section"},[s("p",{staticClass:"text-left supporting-text"},[t._v("タイトル")]),t._v(" "),s("p",{staticClass:"text-left primary-text"},[t._v(t._s(t.room.title))]),t._v(" "),s("div",{staticClass:"result-small-section"},[s("p",{staticClass:"text-left supporting-text"},[t._v("説明")]),t._v(" "),s("p",{staticClass:"text-left primary-text"},[t._v(t._s(t.room.explanation))])]),t._v(" "),s("div",{staticClass:"result-small-section"},[s("p",{staticClass:"text-left supporting-text"},[t._v("選択肢")]),t._v(" "),s("ul",t._l(t.room.options,function(e){return s("li",[s("p",{staticClass:"text-left primary-text"},[t._v(t._s(e))])])}),0)]),t._v(" "),s("div",{staticClass:"result-small-section"},[s("p",{staticClass:"text-left supporting-text"},[t._v("投票のルール")]),t._v(" "),s("p",{staticClass:"text-left primary-text"},[t._v(t._s(t.rule))])]),t._v(" "),t.hasSaved?t._e():s("div",[s("div",{staticClass:"result-small-section"},[s("input",{attrs:{type:"checkbox",id:"setting-checkbox"},domProps:{checked:t.shouldbePublic},on:{change:function(e){return t.changed()}}}),t._v(" "),s("label",{staticClass:"primary-checkbox",attrs:{for:"setting-checkbox"}},[t._v("公開する")])]),t._v(" "),s("div",{staticClass:"result-small-section"},[s("button",{staticClass:"primary-button",attrs:{disabled:!t.hasEdited},on:{click:t.post}},[t._v("保存")])])])])]),t._v(" "),s("div",{staticClass:"result-section"},[t.hasSaved?s("p",{staticClass:"text-left primary-text"},[t._v("変更を保存済み")]):t._e()])])])},staticRenderFns:[]};var T=s("VU/8")(V,D,!1,function(t){s("JArz")},null,null).exports,F=s("eyXe"),P=s("ckgC");n.a.use(i.a);var L=new i.a({routes:[{path:"/",component:c},{path:"/attend",component:_},{path:"/create",component:x},{path:"/roomoutline",name:"roomOutline",component:y},{path:"/roomoutline/form",name:"form",component:E},{path:"/newroom",component:O},{path:"/roomsetting",name:"roomSetting",component:T},{path:"/detail",component:F.default},{path:"/news",component:P.default}],scrollBehavior:function(){return{x:0,y:0}}});n.a.config.productionTip=!1,console.log(Object({NODE_ENV:"production",VUE_APP_API_KEY:"AIzaSyCpGpFoqXPWS6V3yG1GLMLRbuvyf14vwWQ",VUE_APP_AUTH_DOMAIN:"startfirebase-35cbd.firebaseapp.com",VUE_APP_BASE_URL:"https://startfirebase-35cbd.firebaseio.com",VUE_APP_PROJECT_ID:"startfirebase-35cbd",VUE_APP_STORAGE_BUCKET:"startfirebase-35cbd.appspot.com",VUE_APP_MESSAGING_SENDER_ID:"57225796888",VUE_APP_APP_ID:"1:57225796888:web:0c53fe2f52b263116bd26d",VUE_APP_MEASURMENT_ID:"G-6G76HSQ6G2"}));v.a.initializeApp({apiKey:"AIzaSyCpGpFoqXPWS6V3yG1GLMLRbuvyf14vwWQ",authDomain:"startfirebase-35cbd.firebaseapp.com",databaseURL:"https://startfirebase-35cbd.firebaseio.com",projectId:"startfirebase-35cbd",storageBucket:"startfirebase-35cbd.appspot.com",messagingSenderId:"57225796888",appId:"1:57225796888:web:0c53fe2f52b263116bd26d",measurementId:"G-6G76HSQ6G2"}),v.a.auth().signInAnonymously().then(function(){console.log(user.uid)}).catch(function(t){t.code,t.message}),new n.a({el:"#app",router:L,components:{App:r},template:"<App/>"})},"NZ/7":function(t,e){},P2r2:function(t,e){},QIQ4:function(t,e,s){t.exports=s.p+"static/img/logo_img.cbf5727.png"},REmH:function(t,e,s){t.exports=s.p+"static/img/common_language_custom.8d33499.jpg"},RH39:function(t,e,s){"use strict";var n={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"body-padding",attrs:{id:"detail-app"}},[n("div",{staticClass:"home-content"},[n("p",{staticClass:"page-title"},[t._v("本アプリの投票ルールの仕様")]),t._v(" "),n("div",{staticClass:"home-section"},[n("h3",{staticClass:"section-title text-left"},[t._v("マジョリティ・ジャッジメント")]),t._v(" "),n("p",{staticClass:"primary-text text-left"},[t._v("\n        マジョリティ・ジャッジメント(Majority Judgement)は、各候補に対して絶対評価で投票し中央値をその候補の評価とする決め方です。\n        "),n("br"),t._v(" "),n("br"),t._v("\n        <評価を表す語彙について>\n        "),n("br"),t._v("\n        投票の際、評価を表す語彙も判断に影響します。本アプリのデフォルトの語彙は以下の６つですが、カスタマイズすることもできます。\n      ")]),t._v(" "),n("div",{staticClass:"common-language-div"},[n("img",{staticClass:"common-language-img",attrs:{src:s("wa8D")}})]),t._v(" "),n("p",{staticClass:"primary-text text-left"},[t._v("\n        数・言葉ともに編集できるので、投票内容に応じて全員ができるだけ共通の基準で判断できるように設定することが可能です。\n        "),n("br"),t._v(" "),n("br"),t._v("\n        例えば、「良い」「普通」「悪い」の３つに設定して中立な立場を選択可能にしたり、「6」~「1」の６段階にして肯定的か否定的かどちらかの立場を取るよう促したりすることもできます。\n        "),n("br"),t._v(" "),n("br"),t._v("\n        また、絵文字を活用して以下のように言葉を使わない方法で投票を作成することもできます。\n      ")]),t._v(" "),n("div",{staticClass:"common-language-div"},[n("img",{staticClass:"common-language-img",attrs:{src:s("REmH")}})]),t._v(" "),n("div",{staticClass:"break-between-topic"}),t._v(" "),n("p",{staticClass:"primary-text text-left"},[t._v("\n        <タイブレーキングについて>\n        "),n("br"),t._v("\n        投票の結果、中央値に該当する評価が複数の候補で同一となった場合、本アプリでは自動的に、最終的な評価と同じかそれより良い評価をつけた票の数を比較し、それらの票が多い方を高い順位とします。\n        "),n("br"),t._v(" "),n("br"),t._v("\n        <中央値が存在しない場合>\n        "),n("br"),t._v("\n        投票者数が偶数の場合、中央値が存在しない(あるいは中央値が２つ存在する)場合があります。その場合、本アプリではその２つのうち低い方を最終的な評価とします。\n      ")])]),t._v(" "),n("div",{staticClass:"home-section"},[n("h3",{staticClass:"section-title text-left"},[t._v("参考文献")]),t._v(" "),n("ul",[n("li",{staticClass:"primary-text text-left"},[t._v("\n          坂井豊貴.　「決め方」の経済学——「みんなの意見のまとめ方」を科学する.　３刷,　ダイヤモンド社,　2019,　222p.\n        ")]),t._v(" "),n("li",{staticClass:"primary-text text-left"},[t._v("\n          坂井豊貴.　多数決を疑う　社会的選択理論とは何か.　13刷,　岩波書店,　2020,　180p.\n        ")]),t._v(" "),n("li",{staticClass:"primary-text text-left"},[t._v('\n          Michel Balinski,　Rida Laraki.　"A theory of measuring, electing, and ranking".　PNAS.　'),n("a",{staticClass:"reference-link",attrs:{href:"https://www.pnas.org/content/104/21/8720",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.pnas.org/content/104/21/8720")]),t._v(",　(参照2021-03-19)\n        ")]),t._v(" "),n("li",{staticClass:"primary-text text-left"},[t._v('\n          山本芳嗣.　"1人1票からMajority Judgmentへ".　'),n("a",{staticClass:"reference-link",attrs:{href:"http://www.orsj.or.jp/archive2/or57-06/or57_6_295.pdf",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://www.orsj.or.jp/archive2/or57-06/or57_6_295.pdf")]),t._v(",　(参照2021-03-19)\n        ")]),t._v(" "),n("li",{staticClass:"primary-text text-left"},[t._v('\n          "Understanding Majority Judgement".　open agora.　'),n("a",{staticClass:"reference-link",attrs:{href:"https://blog.open-agora.com/en/understanding-majority-judgement-polling-in-slack/#references",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://blog.open-agora.com/en/understanding-majority-judgement-polling-in-slack/#references")]),t._v(",　(参照2021-03-19)\n        ")]),t._v(" "),n("li",{staticClass:"primary-text text-left"},[t._v('\n          Stephen Bosworth,　Anders Corr,　Stevan Leonard.　"Legislatures Elected by Evaluative Proportional Representation (EPR): An Algorithm".　JPR.　'),n("a",{staticClass:"reference-link",attrs:{href:"https://www.jpolrisk.com/legislatures-elected-by-evaluative-proportional-representation-epr-an-algorithm-v2/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.jpolrisk.com/legislatures-elected-by-evaluative-proportional-representation-epr-an-algorithm-v2/")]),t._v(",　(参照2021-03-19)\n        ")])])])])])}]};e.a=n},UK8H:function(t,e){},UM69:function(t,e){},VVw5:function(t,e){},Vb6W:function(t,e){},XV38:function(t,e,s){"use strict";var n={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"body-padding",attrs:{id:"news-app"}},[s("div",{staticClass:"home-content"},[s("p",{staticClass:"page-title"},[t._v("現在確認しているバグ")]),t._v(" "),s("div",{staticClass:"home-section"},[s("ul",{staticClass:"text-left"},[s("div",{staticClass:"news"},[s("li",{staticClass:"primary-text"},[t._v("\n            ボルダルールまたはコンドルセルールで、選択肢を11個以上入力すると投票の結果が表示できないバグが発生しています。ご不便をおかけしていますが、現在修正に取り組んでいます。\n          ")])])])]),t._v(" "),s("p",{staticClass:"page-title"},[t._v("リリースノート")]),t._v(" "),s("div",{staticClass:"home-section"},[s("ul",{staticClass:"text-left"},[s("div",{staticClass:"news"},[s("p",{staticClass:"supporting-text"},[t._v("2021/06/22")]),t._v(" "),s("li",{staticClass:"primary-text"},[t._v("\n            「結果を検証」の新機能\n            "),s("br"),t._v("\n            マジョリティ・ジャッジメントで集計されたルームの結果の画面で、「結果の検証」ボタンを押すと、もし平均を使っていたらどんな結果になっていたかシュミレーションできます。\n            マジョリティ・ジャッジメントは中央値を使っているのが特徴ですが、単純な平均値と比べてどのくらい戦略的操作をされにくいのか、比較する参考になるのではないかと思います。\n          ")])]),t._v(" "),s("div",{staticClass:"news"},[s("p",{staticClass:"supporting-text"},[t._v("2021/04/12")]),t._v(" "),s("li",{staticClass:"primary-text"},[t._v("\n            マジョリティ・ジャッジメント(Majority Judgement)を追加しました。\n            "),s("br"),t._v("\n            マジョリティ・ジャッジメントを採用して投票ルームを作成する場合、評価を表す語彙(「非常に良い」「不十分」など)をカスタマイズすることもできます。\n          ")])]),t._v(" "),s("div",{staticClass:"news"},[s("p",{staticClass:"supporting-text"},[t._v("2021/03/09")]),t._v(" "),s("li",{staticClass:"primary-text"},[t._v("\n            「結果の検証を表示」ボタンの追加。\n            "),s("br"),t._v("\n            結果の画面で、他の投票ルールを採用していたらどのような結果になっていたか、シュミレーションできます。\n            ボルダルールまたはコンドルセ・ヤングの最尤法で集計されたルームのみで表示されます。\n          ")])]),t._v(" "),s("div",{staticClass:"news"},[s("p",{staticClass:"supporting-text"},[t._v("2021/03/07")]),t._v(" "),s("li",{staticClass:"primary-text"},[t._v("\n            投票済みの人数が正しく表示されないことがあるバグを修正。\n          ")])])])])])])}]};e.a=n},"a+S0":function(t,e){},aPfO:function(t,e){},ckgC:function(t,e,s){"use strict";var n=s("mkeU"),a=s.n(n),o=s("XV38");var r=function(t){s("UK8H")},i=s("VU/8")(a.a,o.a,!1,r,null,null);e.default=i.exports},eyXe:function(t,e,s){"use strict";var n=s("u0Au"),a=s.n(n),o=s("RH39");var r=function(t){s("aPfO")},i=s("VU/8")(a.a,o.a,!1,r,null,null);e.default=i.exports},mkeU:function(t,e){},u0Au:function(t,e){},wa8D:function(t,e,s){t.exports=s.p+"static/img/common_language_degault.f4e3cf5.jpg"}},["NHnr"]);
//# sourceMappingURL=app.d843a31af18100c79154.js.map